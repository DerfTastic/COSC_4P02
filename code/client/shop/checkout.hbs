<!DOCTYPE html>
<html lang="en">
<style>
    .content {
        display: flex;
        flex-direction: row;
        gap: 10px;
    }

    .payment {
        display: flex;
        padding: 15px;
        flex-direction: column;
        align-items: flex-start;
        align-self: flex-start;
        gap: 30px;
    }

    .payment-top {
        display: flex;
        padding-bottom: 10px;
        flex-direction: column;
        justify-content: flex-end;
        align-items: flex-start;
        gap: 5px;
        align-self: stretch;
        border-bottom: 3px solid var(--L-Blue, #778DA9);
    }

    .payment-title {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    h1 {
        color: var(--Light, #eeeef0);
        font-size: 48px;
        font-style: normal;
        font-weight: 700;
        line-height: normal;
    }

    .cards {
        height: 48px;
        aspect-ratio: 10/9;
    }

    .card-container {
        display: flex;
        padding: 0px 15px;
        flex-direction: column;
        align-items: flex-start;
    }

    .credit-cards {
        display: flex;
        align-items: center;
        gap: 5px;
    }

    .pay-info {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
        align-self: stretch;
    }

    .payment h2 {
        color: var(--Light, #eeeef0);
        font-size: 36px;
        font-style: normal;
        font-weight: 700;
        line-height: normal;
    }

    .form {
        display: flex;
        padding: 0px 15px;
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
    }

    .input {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 5px;
    }

    .input-row {
        display: flex;
        align-items: flex-start;
        gap: 10px;
    }

    .cvv-description {
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        align-items: flex-start;
        gap: 5px;
    }

    .cvv-description p {
        color: var(--Light, #E6E6E8);
        font-size: 12px;
        font-style: normal;
        font-weight: 400;
        line-height: normal;
    }

    .order-summary {
        display: flex;
        width: 400px;
        padding: 15px;
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
    }

    .summary-title {
        display: flex;
        padding-bottom: 10px;
        flex-direction: column;
        justify-content: flex-end;
        align-items: flex-start;
        gap: 5px;
    }

    h4 {
        color: var(--Light, #E6E6E8);
        font-size: 24px;
        font-style: normal;
        font-weight: 700;
        line-height: normal;
    }

    .price {
        display: flex;
        padding: 0px 15px;
        justify-content: space-between;
        align-items: flex-start;
        align-self: stretch;
    }

    .item {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 5px;
    }

    .sub-total {
        display: flex;
        padding: 5px 15px 5px 0px;
        justify-content: space-between;
        align-items: flex-start;
        align-self: stretch;
    }

    .subtotal {
        display: flex;
        padding: 5px 15px 5px 0px;
        justify-content: space-between;
        align-items: flex-start;
        align-self: stretch;
        border-top: 3px solid var(--L-Blue, #778DA9);
    }

    .button {
        display: flex;
        padding: 5px;
        justify-content: center;
        align-items: center;
        gap: 10px;
        align-self: stretch;
        border-radius: 15px;
        border: 1px solid var(--L-Blue, #778DA9);
    }
</style>


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>
    <script src="/js/api.js"></script>
    <link rel="stylesheet" href="/style/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
</head>
<div class="sticky" src="/partials/header.html" type="text/x-html-template"></div>

<body>
    <div class="content">
        <div class="payment">
            <div class="payment-top">
                <div class="payment-title">
                    <h1>Payment - credit card</h1>
                    <i class="fa-regular fa-credit-card"></i>
                </div>
                <div class="card-container">
                    <div class="credit-cards">
                        <i class="fa-brands fa-cc-visa"></i>
                        <i class="fa-brands fa-cc-mastercard"></i>
                        <i class="fa-brands fa-cc-amex"></i>
                        <p>We accept Visa, Mastercard, and American Express</p>
                    </div>
                </div>
            </div>
            <div class="pay-info">
                <h2>Card Information</h2>
                <form class="form" action="/save_somewhere"> <!---CHANGE ACTION!!!-->
                    <div class="input">
                        <label for="cc-num">*Card Number</label>
                        <input type="text" id="cc-num" name="cc-num">
                    </div>
                    <div class="input-row">
                        <div class="input">
                            <label for="cc-e-Month">*Expiry Month</label>
                            <input type="text" id="cc-e-Month" name="cc-e-Month">
                        </div>
                        <div class="input">
                            <label for="cc-e-Day">*Expiry Day</label>
                            <input type="text" id="cc-e-Day" name="cc-e-Day">
                        </div>
                    </div>
                    <div class="input-row">
                        <div class="input">
                            <label for="cc-cvv">*CVV</label>
                            <input type="text" id="cc-cvv" name="cc-cvv">
                        </div>
                        <div class="cvv-description">
                            <p>This 3 or 4 digit is on the back or front of your card</p>
                        </div>
                    </div>
            </div>
            <div class="pay-info">
                <h2>Billing Information</h2>
                <form class="form" action="/save_somewhere"> <!---CHANGE ACTION!!!-->
                    <div class="input-row">
                        <div class="input">
                            <label for="fname">*First Name</label>
                            <input type="text" id="fname" name="fname">
                        </div>
                        <div class="input">
                            <label for="lname">*Last Name</label>
                            <input type="text" id="lname" name="lname">
                        </div>
                    </div>
                    <div class="input-row">
                        <div class="input">
                            <label for="phone">*Phone Number</label>
                            <input type="text" id="phone" name="phone">
                        </div>
                        <div class="input">
                            <label for="phone-ext">Ext (optional)</label>
                            <input type="text" id="phone-ext" name="phone-ext">
                        </div>
                    </div>
                    <div class="input">
                        <label for="address">*Address</label>
                        <input type="text" id="address" name="address">
                    </div>
                    <div class="input-row">
                        <div class="input">
                            <label for="city">*City</label>
                            <input type="text" id="city" name="city">
                        </div>
                        <div class="input">
                            <label for="province">*Province</label>
                            <input type="text" id="province" name="province">
                        </div>
                        <div class="input">
                            <label for="postal">*Postal Code</label>
                            <input type="text" id="postal" name="postal">
                        </div>
                    </div>
                    <div class="input">
                        <label for="contry">*Contry</label>
                        <input type="text" id="contry" name="contry">
                    </div>
                </form>
            </div>
        </div>
        <script>
            async function get_estamate(){
                var items = new URLSearchParams(window.location.search).get("items");
                items = JSON.parse(items);
                return api.payment.create_estimate(items);
            }

            async function place_order(){
                const payment = {};
                var items = new URLSearchParams(window.location.search).get("items");
                items = JSON.parse(items);
                return api.payment.make_purchase({payment, items});
            }
        </script>
        <div class="order-summary">

            <script src="get_estamate()" type="text/x-handlebars-template">
                <h1>Order Estimate</h1>
                {{!-- <div class="sumary-title">
                    <h4>Event Name</h4>
                </div> --}}
                <div class="pay-info">
                    <div class="price">
                        <div class="item">
                            {{#each items}}
                            <p>{{name}}</p>
                            {{/each}}
                        </div>
                        <div class="item">
                            {{#each items}}
                            <p>{{purchase_price}}</p>
                            {{/each}}
                        </div>
                    </div>
                    <div class="sub-total">
                        <div class="item">
                            <h4>Subtotal</h4>
                        </div>
                        <div class="item">
                            <p>{{subtotal}}</p>
                        </div>
                    </div>
                    <div class="price">
                        <div class="item">
                            <p>Service Fee</p>
                            <p>Tax</p>
                        </div>
                        <div class="item">
                            <p>{{fees}}</p>
                            <p>{{gst}}</p>
                        </div>
                    </div>
                    <div class="total">
                        <div class="item">
                            <h4>Total</h4>
                        </div>
                        <div class="item">
                            <p>{{total}}</p>
                        </div>
                    </div>
                </div>
            </script>
            <div></div>
            <button class="button" type="button" onclick="place_order()">Place Order</button>
            <h4>Security & Privacy</h4>
            <p>Every transaction on Ticket Express is secure. Any personal information you give us will be handled
                according to our <a href="/privacy.html">Privacy Policy</a>.</p>
        </div>
    </div>
    </div>
    <div src="/partials/footer.html" type="text/x-html-template"></div>
</body>

</html>