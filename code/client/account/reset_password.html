<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Caesar+Dressing&family=Caveat:wght@400..700&family=Special+Elite&display=swap"
        rel="stylesheet">
    <link href="https://use.fontawesome.com/releases/v5.0.1/css/all.css" rel="stylesheet">
    <link rel="icon" href="/images/logo.png" sizes="64x64" type="image/x-icon">
    <title> Reset your password</title>
</head>

<body>
    <div class="container">
        <div class="reset-container">
            <form class="reset-form" id="resetForm" method="POST">
                <h2>Reset Password</h2>

                <!-- Email Address -->
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" name="email" placeholder="Enter your email" required />
                </div>

                <!-- New Password -->
                <div class="form-group">
                    <label for="password">New Password</label>
                    <input type="password" id="password" name="password" placeholder="Enter your new password"
                        required />
                </div>

                <!-- Submit Button -->
                <div class="form-group">
                    <button type="submit" class="btn-reset">Submit</button>
                </div>

                <p class="form-footer">
                    Remember your password? <a href="/account/login">Login here</a>
                </p>
            </form>


        </div>
    </div>
    <script>

        document.getElementById('resetForm').addEventListener('submit', async function (event) {
            event.preventDefault();

            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const token = new URLSearchParams(window.location.search).get('token');

            try {
                await api.user.do_reset_password(email, password, token);
                alert('Password reset successful. Redirecting to login...');
                window.location.href = '/account/login';
            } catch ({ error, code }) {
                alert('Error resetting password: ' + error);
            }
        });
    </script>

    <div src="/partials/header.html" type="text/x-html-template"></div>
    <div src="/partials/footer.html" type="text/x-html-template"></div>
    <script src="/js/api.js" type="text/javascript"></script>
</body>

</html>